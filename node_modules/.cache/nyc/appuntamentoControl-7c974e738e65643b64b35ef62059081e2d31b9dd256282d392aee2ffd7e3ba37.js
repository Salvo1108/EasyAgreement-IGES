function cov_1bu7cqjppc(){var path="/Users/salvatore/Desktop/EasyAgreement-IGES/app/controllers/appuntamentoControl.js";var hash="4af23b50a5b44f32e776a684201c86237d2b0c54";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/salvatore/Desktop/EasyAgreement-IGES/app/controllers/appuntamentoControl.js",statementMap:{"0":{start:{line:1,column:26},end:{line:1,column:59}},"1":{start:{line:2,column:9},end:{line:2,column:36}},"2":{start:{line:3,column:13},end:{line:3,column:48}},"3":{start:{line:10,column:0},end:{line:21,column:1}},"4":{start:{line:11,column:2},end:{line:20,column:4}},"5":{start:{line:12,column:23},end:{line:12,column:61}},"6":{start:{line:13,column:4},end:{line:19,column:6}},"7":{start:{line:14,column:6},end:{line:18,column:7}},"8":{start:{line:15,column:8},end:{line:15,column:23}},"9":{start:{line:17,column:8},end:{line:17,column:21}},"10":{start:{line:29,column:0},end:{line:68,column:1}},"11":{start:{line:30,column:2},end:{line:67,column:4}},"12":{start:{line:31,column:15},end:{line:31,column:33}},"13":{start:{line:32,column:23},end:{line:32,column:41}},"14":{start:{line:33,column:20},end:{line:33,column:39}},"15":{start:{line:34,column:16},end:{line:34,column:38}},"16":{start:{line:37,column:21},end:{line:37,column:42}},"17":{start:{line:38,column:21},end:{line:38,column:45}},"18":{start:{line:41,column:19},end:{line:41,column:41}},"19":{start:{line:42,column:18},end:{line:42,column:22}},"20":{start:{line:44,column:4},end:{line:46,column:5}},"21":{start:{line:45,column:6},end:{line:45,column:21}},"22":{start:{line:48,column:4},end:{line:50,column:5}},"23":{start:{line:49,column:6},end:{line:49,column:21}},"24":{start:{line:52,column:4},end:{line:55,column:5}},"25":{start:{line:53,column:6},end:{line:53,column:20}},"26":{start:{line:54,column:6},end:{line:54,column:12}},"27":{start:{line:57,column:23},end:{line:57,column:46}},"28":{start:{line:58,column:4},end:{line:58,column:36}},"29":{start:{line:59,column:4},end:{line:59,column:40}},"30":{start:{line:60,column:19},end:{line:60,column:69}},"31":{start:{line:61,column:4},end:{line:66,column:6}},"32":{start:{line:62,column:14},end:{line:62,column:24}},"33":{start:{line:63,column:17},end:{line:63,column:300}},"34":{start:{line:64,column:6},end:{line:64,column:226}},"35":{start:{line:65,column:6},end:{line:65,column:19}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:10,column:29},end:{line:10,column:30}},loc:{start:{line:10,column:41},end:{line:21,column:1}},line:10},"1":{name:"(anonymous_1)",decl:{start:{line:11,column:21},end:{line:11,column:22}},loc:{start:{line:11,column:48},end:{line:20,column:3}},line:11},"2":{name:"(anonymous_2)",decl:{start:{line:13,column:22},end:{line:13,column:23}},loc:{start:{line:13,column:40},end:{line:19,column:5}},line:13},"3":{name:"(anonymous_3)",decl:{start:{line:29,column:29},end:{line:29,column:30}},loc:{start:{line:29,column:49},end:{line:68,column:1}},line:29},"4":{name:"(anonymous_4)",decl:{start:{line:30,column:21},end:{line:30,column:22}},loc:{start:{line:30,column:48},end:{line:67,column:3}},line:30},"5":{name:"(anonymous_5)",decl:{start:{line:61,column:18},end:{line:61,column:19}},loc:{start:{line:61,column:36},end:{line:66,column:5}},line:61}},branchMap:{"0":{loc:{start:{line:14,column:6},end:{line:18,column:7}},type:"if",locations:[{start:{line:14,column:6},end:{line:18,column:7}},{start:{line:14,column:6},end:{line:18,column:7}}],line:14},"1":{loc:{start:{line:44,column:4},end:{line:46,column:5}},type:"if",locations:[{start:{line:44,column:4},end:{line:46,column:5}},{start:{line:44,column:4},end:{line:46,column:5}}],line:44},"2":{loc:{start:{line:44,column:8},end:{line:44,column:51}},type:"binary-expr",locations:[{start:{line:44,column:9},end:{line:44,column:21}},{start:{line:44,column:27},end:{line:44,column:50}}],line:44},"3":{loc:{start:{line:48,column:4},end:{line:50,column:5}},type:"if",locations:[{start:{line:48,column:4},end:{line:50,column:5}},{start:{line:48,column:4},end:{line:50,column:5}}],line:48},"4":{loc:{start:{line:48,column:8},end:{line:48,column:58}},type:"binary-expr",locations:[{start:{line:48,column:9},end:{line:48,column:25}},{start:{line:48,column:31},end:{line:48,column:57}}],line:48},"5":{loc:{start:{line:52,column:4},end:{line:55,column:5}},type:"if",locations:[{start:{line:52,column:4},end:{line:55,column:5}},{start:{line:52,column:4},end:{line:55,column:5}}],line:52}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"4af23b50a5b44f32e776a684201c86237d2b0c54"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1bu7cqjppc=function(){return actualCoverage;};}return actualCoverage;}cov_1bu7cqjppc();const AppuntamentoModel=(cov_1bu7cqjppc().s[0]++,require('../models/appuntamento'));var io=(cov_1bu7cqjppc().s[1]++,require('socket.io-client'));var socket=(cov_1bu7cqjppc().s[2]++,io.connect('http://localhost:3000'));/**
 * This method retrieves all appointment
* @param {Object} req - The HTTP req
 * @param {Object} res - The HTTP response
 * @returns {Int} - 
 */cov_1bu7cqjppc().s[3]++;exports.getAllAppointments=function(){cov_1bu7cqjppc().f[0]++;cov_1bu7cqjppc().s[4]++;return new Promise(function(resolve,reject){cov_1bu7cqjppc().f[1]++;var appointments=(cov_1bu7cqjppc().s[5]++,AppuntamentoModel.getAllAppuntamenti());cov_1bu7cqjppc().s[6]++;appointments.then(function(result){cov_1bu7cqjppc().f[2]++;cov_1bu7cqjppc().s[7]++;if(result.length>0){cov_1bu7cqjppc().b[0][0]++;cov_1bu7cqjppc().s[8]++;resolve(result);}else{cov_1bu7cqjppc().b[0][1]++;cov_1bu7cqjppc().s[9]++;resolve(null);}});});};/**
 * This method inserts a specific appointment
* @param {Object} req - The HTTP req
 * @param {Object} res - The HTTP res
 * @returns {Boolean}  - This method returns true if the insert of appointment was successfull, else false
 */cov_1bu7cqjppc().s[10]++;exports.insertAppuntamento=function(req,res){cov_1bu7cqjppc().f[3]++;cov_1bu7cqjppc().s[11]++;return new Promise(function(resolve,reject){cov_1bu7cqjppc().f[4]++;var date=(cov_1bu7cqjppc().s[12]++,req.body.inputDate);var dataNotifica=(cov_1bu7cqjppc().s[13]++,req.body.inputDate);var studentID=(cov_1bu7cqjppc().s[14]++,req.query.studentID);var email=(cov_1bu7cqjppc().s[15]++,req.query.studentEmail);//var studentID_Temp = req.body.studentID_Temp
//var email_Temp = req.body.studentEmail_Temp
var RegExpData=(cov_1bu7cqjppc().s[16]++,/^\d{4}-\d{2}-\d{2}$/);var RegExpOra=(cov_1bu7cqjppc().s[17]++,/^\d{1,2}[:][0-5][0-9]$/);var schedule=(cov_1bu7cqjppc().s[18]++,req.body.inputSchedule);var isRight=(cov_1bu7cqjppc().s[19]++,true);cov_1bu7cqjppc().s[20]++;if((cov_1bu7cqjppc().b[2][0]++,date==null)||(cov_1bu7cqjppc().b[2][1]++,!date.match(RegExpData))){cov_1bu7cqjppc().b[1][0]++;cov_1bu7cqjppc().s[21]++;isRight=false;}else{cov_1bu7cqjppc().b[1][1]++;}cov_1bu7cqjppc().s[22]++;if((cov_1bu7cqjppc().b[4][0]++,schedule==null)||(cov_1bu7cqjppc().b[4][1]++,!schedule.match(RegExpOra))){cov_1bu7cqjppc().b[3][0]++;cov_1bu7cqjppc().s[23]++;isRight=false;}else{cov_1bu7cqjppc().b[3][1]++;}cov_1bu7cqjppc().s[24]++;if(!isRight){cov_1bu7cqjppc().b[5][0]++;cov_1bu7cqjppc().s[25]++;resolve(false);cov_1bu7cqjppc().s[26]++;return;}else{cov_1bu7cqjppc().b[5][1]++;}var appuntamento=(cov_1bu7cqjppc().s[27]++,new AppuntamentoModel());cov_1bu7cqjppc().s[28]++;appuntamento.setTitle(studentID);cov_1bu7cqjppc().s[29]++;appuntamento.setStart(date,schedule);var inserted=(cov_1bu7cqjppc().s[30]++,AppuntamentoModel.insertAppuntamento(appuntamento));cov_1bu7cqjppc().s[31]++;inserted.then(function(result){cov_1bu7cqjppc().f[5]++;var d=(cov_1bu7cqjppc().s[32]++,new Date());var date=(cov_1bu7cqjppc().s[33]++,{hour:d.getHours().toString().padStart(2,0),minutes:d.getMinutes().toString().padStart(2,0),seconds:d.getSeconds().toString().padStart(2,0),day:d.getDate().toString().padStart(2,0),month:(d.getMonth()+1).toString().padStart(2,0),year:d.getFullYear().toString()});cov_1bu7cqjppc().s[34]++;socket.emit('send-notification',{associatedID:email,text:{title:'Nuovo Colloquio',text:'Il Commissario Internazionale ha fissato il colloquio per il giorno '+dataNotifica+", ore "+schedule},date:date});cov_1bu7cqjppc().s[35]++;resolve(true);});});};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcHVudGFtZW50b0NvbnRyb2wuanMiXSwibmFtZXMiOlsiQXBwdW50YW1lbnRvTW9kZWwiLCJyZXF1aXJlIiwiaW8iLCJzb2NrZXQiLCJjb25uZWN0IiwiZXhwb3J0cyIsImdldEFsbEFwcG9pbnRtZW50cyIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwiYXBwb2ludG1lbnRzIiwiZ2V0QWxsQXBwdW50YW1lbnRpIiwidGhlbiIsInJlc3VsdCIsImxlbmd0aCIsImluc2VydEFwcHVudGFtZW50byIsInJlcSIsInJlcyIsImRhdGUiLCJib2R5IiwiaW5wdXREYXRlIiwiZGF0YU5vdGlmaWNhIiwic3R1ZGVudElEIiwicXVlcnkiLCJlbWFpbCIsInN0dWRlbnRFbWFpbCIsIlJlZ0V4cERhdGEiLCJSZWdFeHBPcmEiLCJzY2hlZHVsZSIsImlucHV0U2NoZWR1bGUiLCJpc1JpZ2h0IiwibWF0Y2giLCJhcHB1bnRhbWVudG8iLCJzZXRUaXRsZSIsInNldFN0YXJ0IiwiaW5zZXJ0ZWQiLCJkIiwiRGF0ZSIsImhvdXIiLCJnZXRIb3VycyIsInRvU3RyaW5nIiwicGFkU3RhcnQiLCJtaW51dGVzIiwiZ2V0TWludXRlcyIsInNlY29uZHMiLCJnZXRTZWNvbmRzIiwiZGF5IiwiZ2V0RGF0ZSIsIm1vbnRoIiwiZ2V0TW9udGgiLCJ5ZWFyIiwiZ2V0RnVsbFllYXIiLCJlbWl0IiwiYXNzb2NpYXRlZElEIiwidGV4dCIsInRpdGxlIl0sIm1hcHBpbmdzIjoidTdKQWVZOzJGQWZaLEtBQU1BLENBQUFBLGlCQUFpQiwwQkFBR0MsT0FBTyxDQUFDLHdCQUFELENBQVYsQ0FBdkIsQ0FDQSxHQUFJQyxDQUFBQSxFQUFFLDBCQUFHRCxPQUFPLENBQUMsa0JBQUQsQ0FBVixDQUFOLENBQ0EsR0FBSUUsQ0FBQUEsTUFBTSwwQkFBR0QsRUFBRSxDQUFDRSxPQUFILENBQVcsdUJBQVgsQ0FBSCxDQUFWLENBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEcsd0JBQ0FDLE9B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LEdBQWVILFFBQWYsR0FBMEJDLFFBQTFCLENBQW1DLENBQW5DLENBQXNDLENBQXRDLENBQXpELENBQW1HRyxPQUFPLENBQUVSLENBQUMsQ0FBQ1MsVUFBRixHQUFlTCxRQUFmLEdBQTBCQyxRQUExQixDQUFtQyxDQUFuQyxDQUFzQyxDQUF0QyxDQUE1RyxDQUFzSkssR0FBRyxDQUFFVixDQUFDLENBQUNXLE9BQUYsR0FBWVAsUUFBWixHQUF1QkMsUUFBdkIsQ0FBZ0MsQ0FBaEMsQ0FBbUMsQ0FBbkMsQ0FBM0osQ0FBa01PLEtBQUssQ0FBRSxDQUFFWixDQUFDLENBQUNhLFFBQUYsRUFBRCxDQUFpQixDQUFsQixFQUFxQlQsUUFBckIsR0FBZ0NDLFFBQWhDLENBQXlDLENBQXpDLENBQTRDLENBQTVDLENBQXpNLENBQXlQUyxJQUFJLENBQUVkLENBQUMsQ0FBQ2UsV0FBRixHQUFnQlgsUUFBaEIsRUFBL1AsQ0FBSCxDQUFSLENBRjhCLHlCQUc5QnJDLE1BQU0sQ0FBQ2lELElBQVAsQ0FBWSxtQkFBWixDQUFpQyxDQUFFQyxZQUFZLENBQUU3QixLQUFoQixDQUF1QjhCLElBQUksQ0FBRSxDQUFFQyxLQUFLLENBQUUsaUJBQVQsQ0FBNEJELElBQUksQ0FBRSx1RUFBeUVqQyxZQUF6RSxDQUF3RixRQUF4RixDQUFtR08sUUFBckksQ0FBN0IsQ0FBOEtWLElBQUksQ0FBRUEsSUFBcEwsQ0FBakMsRUFIOEIseUJBSTlCVixPQUFPLENBQUMsSUFBRCxDQUFQLENBQ0QsQ0FMRCxFQU1ELENBckNNLENBQVAsQ0FzQ0QsQ0F2Q0QiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBBcHB1bnRhbWVudG9Nb2RlbCA9IHJlcXVpcmUoJy4uL21vZGVscy9hcHB1bnRhbWVudG8nKVxudmFyIGlvID0gcmVxdWlyZSgnc29ja2V0LmlvLWNsaWVudCcpXG52YXIgc29ja2V0ID0gaW8uY29ubmVjdCgnaHR0cDovL2xvY2FsaG9zdDozMDAwJylcbi8qKlxuICogVGhpcyBtZXRob2QgcmV0cmlldmVzIGFsbCBhcHBvaW50bWVudFxuKiBAcGFyYW0ge09iamVjdH0gcmVxIC0gVGhlIEhUVFAgcmVxXG4gKiBAcGFyYW0ge09iamVjdH0gcmVzIC0gVGhlIEhUVFAgcmVzcG9uc2VcbiAqIEByZXR1cm5zIHtJbnR9IC0gXG4gKi9cbmV4cG9ydHMuZ2V0QWxsQXBwb2ludG1lbnRzID0gZnVuY3Rpb24gKCkge1xuICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgIHZhciBhcHBvaW50bWVudHMgPSBBcHB1bnRhbWVudG9Nb2RlbC5nZXRBbGxBcHB1bnRhbWVudGkoKVxuICAgIGFwcG9pbnRtZW50cy50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgIGlmIChyZXN1bHQubGVuZ3RoID4gMCkge1xuICAgICAgICByZXNvbHZlKHJlc3VsdClcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc29sdmUobnVsbClcbiAgICAgIH1cbiAgICB9KVxuICB9KVxufVxuXG4vKipcbiAqIFRoaXMgbWV0aG9kIGluc2VydHMgYSBzcGVjaWZpYyBhcHBvaW50bWVudFxuKiBAcGFyYW0ge09iamVjdH0gcmVxIC0gVGhlIEhUVFAgcmVxXG4gKiBAcGFyYW0ge09iamVjdH0gcmVzIC0gVGhlIEhUVFAgcmVzXG4gKiBAcmV0dXJucyB7Qm9vbGVhbn0gIC0gVGhpcyBtZXRob2QgcmV0dXJucyB0cnVlIGlmIHRoZSBpbnNlcnQgb2YgYXBwb2ludG1lbnQgd2FzIHN1Y2Nlc3NmdWxsLCBlbHNlIGZhbHNlXG4gKi9cbmV4cG9ydHMuaW5zZXJ0QXBwdW50YW1lbnRvID0gZnVuY3Rpb24gKHJlcSwgcmVzKSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgdmFyIGRhdGUgPSByZXEuYm9keS5pbnB1dERhdGVcbiAgICB2YXIgZGF0YU5vdGlmaWNhID0gcmVxLmJvZHkuaW5wdXREYXRlXG4gICAgdmFyIHN0dWRlbnRJRCA9IHJlcS5xdWVyeS5zdHVkZW50SURcbiAgICB2YXIgZW1haWwgPSByZXEucXVlcnkuc3R1ZGVudEVtYWlsXG4gICAgLy92YXIgc3R1ZGVudElEX1RlbXAgPSByZXEuYm9keS5zdHVkZW50SURfVGVtcFxuICAgIC8vdmFyIGVtYWlsX1RlbXAgPSByZXEuYm9keS5zdHVkZW50RW1haWxfVGVtcFxuICAgIHZhciBSZWdFeHBEYXRhID0gL15cXGR7NH0tXFxkezJ9LVxcZHsyfSQvXG4gICAgdmFyIFJlZ0V4cE9yYSA9ICAvXlxcZHsxLDJ9WzpdWzAtNV1bMC05XSQvXG4gIFxuXG4gICAgdmFyIHNjaGVkdWxlID0gcmVxLmJvZHkuaW5wdXRTY2hlZHVsZVxuICAgIHZhciBpc1JpZ2h0ID0gdHJ1ZTtcblxuICAgIGlmICgoZGF0ZSA9PSBudWxsKSB8fCAoIWRhdGUubWF0Y2goUmVnRXhwRGF0YSkpKSB7XG4gICAgICBpc1JpZ2h0ID0gZmFsc2VcbiAgICB9XG4gICAgIFxuICAgIGlmICgoc2NoZWR1bGUgPT0gbnVsbCkgfHwgKCFzY2hlZHVsZS5tYXRjaChSZWdFeHBPcmEpKSkge1xuICAgICAgaXNSaWdodCA9IGZhbHNlXG4gICAgfVxuXG4gICAgaWYgKCFpc1JpZ2h0KSB7XG4gICAgICByZXNvbHZlKGZhbHNlKVxuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgdmFyIGFwcHVudGFtZW50byA9IG5ldyBBcHB1bnRhbWVudG9Nb2RlbCgpXG4gICAgYXBwdW50YW1lbnRvLnNldFRpdGxlKHN0dWRlbnRJRClcbiAgICBhcHB1bnRhbWVudG8uc2V0U3RhcnQoZGF0ZSxzY2hlZHVsZSlcbiAgICB2YXIgaW5zZXJ0ZWQgPSBBcHB1bnRhbWVudG9Nb2RlbC5pbnNlcnRBcHB1bnRhbWVudG8oYXBwdW50YW1lbnRvKVxuICAgIGluc2VydGVkLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgdmFyIGQgPSBuZXcgRGF0ZSgpXG4gICAgICB2YXIgZGF0ZSA9IHsgaG91cjogZC5nZXRIb3VycygpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgMCksIG1pbnV0ZXM6IGQuZ2V0TWludXRlcygpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgMCksIHNlY29uZHM6IGQuZ2V0U2Vjb25kcygpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgMCksIGRheTogZC5nZXREYXRlKCkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAwKSwgbW9udGg6ICgoZC5nZXRNb250aCgpKSArIDEpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgMCksIHllYXI6IGQuZ2V0RnVsbFllYXIoKS50b1N0cmluZygpIH1cbiAgICAgIHNvY2tldC5lbWl0KCdzZW5kLW5vdGlmaWNhdGlvbicsIHsgYXNzb2NpYXRlZElEOiBlbWFpbCwgdGV4dDogeyB0aXRsZTogJ051b3ZvIENvbGxvcXVpbycsIHRleHQ6ICdJbCBDb21taXNzYXJpbyBJbnRlcm5hemlvbmFsZSBoYSBmaXNzYXRvIGlsIGNvbGxvcXVpbyBwZXIgaWwgZ2lvcm5vICcgKyBkYXRhTm90aWZpY2EgKyBcIiwgb3JlIFwiICsgc2NoZWR1bGUgfSwgZGF0ZTogZGF0ZSB9KVxuICAgICAgcmVzb2x2ZSh0cnVlKVxuICAgIH0pXG4gIH0pXG59XG5cbiJdfQ==