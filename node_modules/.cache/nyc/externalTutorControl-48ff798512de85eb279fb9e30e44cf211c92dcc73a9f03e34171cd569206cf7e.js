function cov_2bptsyfipc(){var path="/Users/salvatore/Desktop/EasyAgreement-IGES/app/controllers/externalTutorControl.js";var hash="e27cf3a84ae0b97b15b1edb8c5c141134730bcaa";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/salvatore/Desktop/EasyAgreement-IGES/app/controllers/externalTutorControl.js",statementMap:{"0":{start:{line:1,column:11},end:{line:1,column:31}},"1":{start:{line:2,column:25},end:{line:2,column:62}},"2":{start:{line:10,column:0},end:{line:66,column:1}},"3":{start:{line:11,column:2},end:{line:65,column:4}},"4":{start:{line:12,column:15},end:{line:12,column:34}},"5":{start:{line:13,column:18},end:{line:13,column:40}},"6":{start:{line:14,column:23},end:{line:14,column:49}},"7":{start:{line:16,column:24},end:{line:16,column:48}},"8":{start:{line:19,column:18},end:{line:19,column:22}},"9":{start:{line:20,column:4},end:{line:27,column:5}},"10":{start:{line:21,column:6},end:{line:26,column:7}},"11":{start:{line:22,column:8},end:{line:22,column:47}},"12":{start:{line:23,column:8},end:{line:23,column:23}},"13":{start:{line:25,column:8},end:{line:25,column:35}},"14":{start:{line:29,column:4},end:{line:36,column:5}},"15":{start:{line:30,column:6},end:{line:35,column:7}},"16":{start:{line:31,column:8},end:{line:31,column:50}},"17":{start:{line:32,column:8},end:{line:32,column:23}},"18":{start:{line:34,column:8},end:{line:34,column:41}},"19":{start:{line:38,column:4},end:{line:45,column:5}},"20":{start:{line:39,column:6},end:{line:44,column:7}},"21":{start:{line:40,column:8},end:{line:40,column:46}},"22":{start:{line:41,column:8},end:{line:41,column:23}},"23":{start:{line:43,column:8},end:{line:43,column:51}},"24":{start:{line:47,column:4},end:{line:50,column:5}},"25":{start:{line:48,column:6},end:{line:48,column:20}},"26":{start:{line:49,column:6},end:{line:49,column:12}},"27":{start:{line:52,column:17},end:{line:52,column:104}},"28":{start:{line:58,column:4},end:{line:64,column:6}},"29":{start:{line:59,column:6},end:{line:63,column:26}},"30":{start:{line:60,column:8},end:{line:60,column:42}},"31":{start:{line:61,column:8},end:{line:61,column:36}},"32":{start:{line:62,column:8},end:{line:62,column:21}},"33":{start:{line:63,column:15},end:{line:63,column:24}},"34":{start:{line:74,column:0},end:{line:127,column:1}},"35":{start:{line:75,column:2},end:{line:126,column:4}},"36":{start:{line:76,column:22},end:{line:76,column:47}},"37":{start:{line:77,column:19},end:{line:77,column:41}},"38":{start:{line:78,column:26},end:{line:78,column:55}},"39":{start:{line:81,column:18},end:{line:81,column:22}},"40":{start:{line:83,column:4},end:{line:86,column:5}},"41":{start:{line:84,column:6},end:{line:84,column:39}},"42":{start:{line:85,column:6},end:{line:85,column:21}},"43":{start:{line:88,column:4},end:{line:92,column:5}},"44":{start:{line:89,column:6},end:{line:89,column:36}},"45":{start:{line:91,column:6},end:{line:91,column:21}},"46":{start:{line:94,column:4},end:{line:98,column:5}},"47":{start:{line:95,column:6},end:{line:95,column:43}},"48":{start:{line:97,column:6},end:{line:97,column:21}},"49":{start:{line:100,column:4},end:{line:103,column:5}},"50":{start:{line:101,column:6},end:{line:101,column:20}},"51":{start:{line:102,column:6},end:{line:102,column:12}},"52":{start:{line:105,column:4},end:{line:125,column:5}},"53":{start:{line:106,column:27},end:{line:106,column:54}},"54":{start:{line:108,column:19},end:{line:108,column:102}},"55":{start:{line:115,column:6},end:{line:121,column:8}},"56":{start:{line:116,column:8},end:{line:120,column:28}},"57":{start:{line:117,column:10},end:{line:117,column:44}},"58":{start:{line:118,column:10},end:{line:118,column:42}},"59":{start:{line:119,column:10},end:{line:119,column:23}},"60":{start:{line:120,column:17},end:{line:120,column:26}},"61":{start:{line:123,column:6},end:{line:123,column:36}},"62":{start:{line:124,column:6},end:{line:124,column:20}},"63":{start:{line:134,column:0},end:{line:141,column:1}},"64":{start:{line:135,column:2},end:{line:140,column:4}},"65":{start:{line:136,column:14},end:{line:136,column:51}},"66":{start:{line:137,column:4},end:{line:139,column:6}},"67":{start:{line:138,column:6},end:{line:138,column:138}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:10,column:17},end:{line:10,column:18}},loc:{start:{line:10,column:37},end:{line:66,column:1}},line:10},"1":{name:"(anonymous_1)",decl:{start:{line:11,column:21},end:{line:11,column:22}},loc:{start:{line:11,column:48},end:{line:65,column:3}},line:11},"2":{name:"(anonymous_2)",decl:{start:{line:58,column:16},end:{line:58,column:17}},loc:{start:{line:58,column:34},end:{line:64,column:5}},line:58},"3":{name:"(anonymous_3)",decl:{start:{line:74,column:25},end:{line:74,column:26}},loc:{start:{line:74,column:45},end:{line:127,column:1}},line:74},"4":{name:"(anonymous_4)",decl:{start:{line:75,column:21},end:{line:75,column:22}},loc:{start:{line:75,column:48},end:{line:126,column:3}},line:75},"5":{name:"(anonymous_5)",decl:{start:{line:115,column:18},end:{line:115,column:19}},loc:{start:{line:115,column:36},end:{line:121,column:7}},line:115},"6":{name:"(anonymous_6)",decl:{start:{line:134,column:21},end:{line:134,column:22}},loc:{start:{line:134,column:38},end:{line:141,column:1}},line:134},"7":{name:"(anonymous_7)",decl:{start:{line:135,column:21},end:{line:135,column:22}},loc:{start:{line:135,column:48},end:{line:140,column:3}},line:135},"8":{name:"(anonymous_8)",decl:{start:{line:137,column:13},end:{line:137,column:14}},loc:{start:{line:137,column:31},end:{line:139,column:5}},line:137}},branchMap:{"0":{loc:{start:{line:20,column:4},end:{line:27,column:5}},type:"if",locations:[{start:{line:20,column:4},end:{line:27,column:5}},{start:{line:20,column:4},end:{line:27,column:5}}],line:20},"1":{loc:{start:{line:21,column:6},end:{line:26,column:7}},type:"if",locations:[{start:{line:21,column:6},end:{line:26,column:7}},{start:{line:21,column:6},end:{line:26,column:7}}],line:21},"2":{loc:{start:{line:21,column:10},end:{line:21,column:57}},type:"binary-expr",locations:[{start:{line:21,column:10},end:{line:21,column:37}},{start:{line:21,column:41},end:{line:21,column:57}}],line:21},"3":{loc:{start:{line:29,column:4},end:{line:36,column:5}},type:"if",locations:[{start:{line:29,column:4},end:{line:36,column:5}},{start:{line:29,column:4},end:{line:36,column:5}}],line:29},"4":{loc:{start:{line:30,column:6},end:{line:35,column:7}},type:"if",locations:[{start:{line:30,column:6},end:{line:35,column:7}},{start:{line:30,column:6},end:{line:35,column:7}}],line:30},"5":{loc:{start:{line:30,column:10},end:{line:30,column:63}},type:"binary-expr",locations:[{start:{line:30,column:10},end:{line:30,column:40}},{start:{line:30,column:44},end:{line:30,column:63}}],line:30},"6":{loc:{start:{line:38,column:4},end:{line:45,column:5}},type:"if",locations:[{start:{line:38,column:4},end:{line:45,column:5}},{start:{line:38,column:4},end:{line:45,column:5}}],line:38},"7":{loc:{start:{line:39,column:6},end:{line:44,column:7}},type:"if",locations:[{start:{line:39,column:6},end:{line:44,column:7}},{start:{line:39,column:6},end:{line:44,column:7}}],line:39},"8":{loc:{start:{line:39,column:10},end:{line:39,column:73}},type:"binary-expr",locations:[{start:{line:39,column:10},end:{line:39,column:45}},{start:{line:39,column:49},end:{line:39,column:73}}],line:39},"9":{loc:{start:{line:47,column:4},end:{line:50,column:5}},type:"if",locations:[{start:{line:47,column:4},end:{line:50,column:5}},{start:{line:47,column:4},end:{line:50,column:5}}],line:47},"10":{loc:{start:{line:59,column:6},end:{line:63,column:26}},type:"if",locations:[{start:{line:59,column:6},end:{line:63,column:26}},{start:{line:59,column:6},end:{line:63,column:26}}],line:59},"11":{loc:{start:{line:83,column:4},end:{line:86,column:5}},type:"if",locations:[{start:{line:83,column:4},end:{line:86,column:5}},{start:{line:83,column:4},end:{line:86,column:5}}],line:83},"12":{loc:{start:{line:83,column:8},end:{line:83,column:99}},type:"binary-expr",locations:[{start:{line:83,column:9},end:{line:83,column:28}},{start:{line:83,column:34},end:{line:83,column:57}},{start:{line:83,column:63},end:{line:83,column:98}}],line:83},"13":{loc:{start:{line:88,column:4},end:{line:92,column:5}},type:"if",locations:[{start:{line:88,column:4},end:{line:92,column:5}},{start:{line:88,column:4},end:{line:92,column:5}}],line:88},"14":{loc:{start:{line:88,column:8},end:{line:88,column:90}},type:"binary-expr",locations:[{start:{line:88,column:9},end:{line:88,column:25}},{start:{line:88,column:31},end:{line:88,column:51}},{start:{line:88,column:57},end:{line:88,column:89}}],line:88},"15":{loc:{start:{line:94,column:4},end:{line:98,column:5}},type:"if",locations:[{start:{line:94,column:4},end:{line:98,column:5}},{start:{line:94,column:4},end:{line:98,column:5}}],line:94},"16":{loc:{start:{line:100,column:4},end:{line:103,column:5}},type:"if",locations:[{start:{line:100,column:4},end:{line:103,column:5}},{start:{line:100,column:4},end:{line:103,column:5}}],line:100},"17":{loc:{start:{line:105,column:4},end:{line:125,column:5}},type:"if",locations:[{start:{line:105,column:4},end:{line:125,column:5}},{start:{line:105,column:4},end:{line:125,column:5}}],line:105},"18":{loc:{start:{line:116,column:8},end:{line:120,column:28}},type:"if",locations:[{start:{line:116,column:8},end:{line:120,column:28}},{start:{line:116,column:8},end:{line:120,column:28}}],line:116}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0,0],"13":[0,0],"14":[0,0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"e27cf3a84ae0b97b15b1edb8c5c141134730bcaa"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_2bptsyfipc=function(){return actualCoverage;};}return actualCoverage;}cov_2bptsyfipc();var hash=(cov_2bptsyfipc().s[0]++,require('./hash.js'));var ExternalTutorModel=(cov_2bptsyfipc().s[1]++,require('../models/externaltutor.js'));/**
 * This method updates the external tutor's informations
 * @param {Object} req - The HTTP request
 * @param {Object} res - The HTTP response
 * @returns {Boolean}  - It returns true if the update was successfull, else false
 */cov_2bptsyfipc().s[2]++;exports.update=function(req,res){cov_2bptsyfipc().f[0]++;cov_2bptsyfipc().s[3]++;return new Promise(function(resolve,reject){cov_2bptsyfipc().f[1]++;var name=(cov_2bptsyfipc().s[4]++,req.body.inputNameE);var surname=(cov_2bptsyfipc().s[5]++,req.body.inputSurnameE);var organization=(cov_2bptsyfipc().s[6]++,req.body.inputOrganization);var externalTutor=(cov_2bptsyfipc().s[7]++,new ExternalTutorModel());// Form validation
var isRight=(cov_2bptsyfipc().s[8]++,true);cov_2bptsyfipc().s[9]++;if(name.length!=0){cov_2bptsyfipc().b[0][0]++;cov_2bptsyfipc().s[10]++;if((cov_2bptsyfipc().b[2][0]++,!/^[A-Za-z]+$/.test(name))||(cov_2bptsyfipc().b[2][1]++,name.length<=2)){cov_2bptsyfipc().b[1][0]++;cov_2bptsyfipc().s[11]++;res.cookie('errexternalTutorName','1');cov_2bptsyfipc().s[12]++;isRight=false;}else{cov_2bptsyfipc().b[1][1]++;cov_2bptsyfipc().s[13]++;externalTutor.setName(name);}}else{cov_2bptsyfipc().b[0][1]++;}cov_2bptsyfipc().s[14]++;if(surname.length!=0){cov_2bptsyfipc().b[3][0]++;cov_2bptsyfipc().s[15]++;if((cov_2bptsyfipc().b[5][0]++,!/^[A-Za-z]+$/.test(surname))||(cov_2bptsyfipc().b[5][1]++,surname.length<=2)){cov_2bptsyfipc().b[4][0]++;cov_2bptsyfipc().s[16]++;res.cookie('errexternalTutorSurname','1');cov_2bptsyfipc().s[17]++;isRight=false;}else{cov_2bptsyfipc().b[4][1]++;cov_2bptsyfipc().s[18]++;externalTutor.setSurname(surname);}}else{cov_2bptsyfipc().b[3][1]++;}cov_2bptsyfipc().s[19]++;if(organization.length!=0){cov_2bptsyfipc().b[6][0]++;cov_2bptsyfipc().s[20]++;if((cov_2bptsyfipc().b[8][0]++,!/^[A-Za-z]+$/.test(organization))||(cov_2bptsyfipc().b[8][1]++,organization.length<=2)){cov_2bptsyfipc().b[7][0]++;cov_2bptsyfipc().s[21]++;res.cookie('errOrganizationName','1');cov_2bptsyfipc().s[22]++;isRight=false;}else{cov_2bptsyfipc().b[7][1]++;cov_2bptsyfipc().s[23]++;externalTutor.setOrganization(organization);}}else{cov_2bptsyfipc().b[6][1]++;}cov_2bptsyfipc().s[24]++;if(!isRight){cov_2bptsyfipc().b[9][0]++;cov_2bptsyfipc().s[25]++;resolve(false);cov_2bptsyfipc().s[26]++;return;}else{cov_2bptsyfipc().b[9][1]++;}var checkS=(cov_2bptsyfipc().s[27]++,ExternalTutorModel.updateExternalTutor(externalTutor,req.session.utente.utente.E_mail));/**
        * It checks the result of updateExternalTutor function and updates the external tutor session
        * @param  {Object} result - The result of updateExternalTutor function
        * @returns {Boolean} - It returns true and generates an "edit complete" cookie if result != null, else it returns a reject
        */cov_2bptsyfipc().s[28]++;checkS.then(function(result){cov_2bptsyfipc().f[2]++;cov_2bptsyfipc().s[29]++;if(result!=null){cov_2bptsyfipc().b[10][0]++;cov_2bptsyfipc().s[30]++;req.session.utente.utente=result;cov_2bptsyfipc().s[31]++;res.cookie('updateEff','1');cov_2bptsyfipc().s[32]++;resolve(true);}else{cov_2bptsyfipc().b[10][1]++;cov_2bptsyfipc().s[33]++;resolve();}});});};/**
 * This method updates the external tutor's password
 * @param {Object} req - The HTTP request
 * @param {Object} res - The HTTP response
 * @returns {Boolean}  - It returns true if the update was successfull, else false
  */cov_2bptsyfipc().s[34]++;exports.updatePassword=function(req,res){cov_2bptsyfipc().f[3]++;cov_2bptsyfipc().s[35]++;return new Promise(function(resolve,reject){cov_2bptsyfipc().f[4]++;var oldPassword=(cov_2bptsyfipc().s[36]++,req.body.inputOldPassword);var password=(cov_2bptsyfipc().s[37]++,req.body.inputPassword);var passwordConfirm=(cov_2bptsyfipc().s[38]++,req.body.inputConfirmPassword);// Form Validation
var isRight=(cov_2bptsyfipc().s[39]++,true);cov_2bptsyfipc().s[40]++;if((cov_2bptsyfipc().b[12][0]++,oldPassword==null)||(cov_2bptsyfipc().b[12][1]++,oldPassword.length<=7)||(cov_2bptsyfipc().b[12][2]++,!/^[A-Za-z0-9]+$/.test(oldPassword))){cov_2bptsyfipc().b[11][0]++;cov_2bptsyfipc().s[41]++;res.cookie('errOldPassword','1');cov_2bptsyfipc().s[42]++;isRight=false;}else{cov_2bptsyfipc().b[11][1]++;}cov_2bptsyfipc().s[43]++;if((cov_2bptsyfipc().b[14][0]++,password==null)||(cov_2bptsyfipc().b[14][1]++,password.length<=7)||(cov_2bptsyfipc().b[14][2]++,!/^[A-Za-z0-9]+$/.test(password))){cov_2bptsyfipc().b[13][0]++;cov_2bptsyfipc().s[44]++;res.cookie('errPassword','1');cov_2bptsyfipc().s[45]++;isRight=false;}else{cov_2bptsyfipc().b[13][1]++;}cov_2bptsyfipc().s[46]++;if(passwordConfirm!=password){cov_2bptsyfipc().b[15][0]++;cov_2bptsyfipc().s[47]++;res.cookie('errPasswordConfirm','1');cov_2bptsyfipc().s[48]++;isRight=false;}else{cov_2bptsyfipc().b[15][1]++;}cov_2bptsyfipc().s[49]++;if(!isRight){cov_2bptsyfipc().b[16][0]++;cov_2bptsyfipc().s[50]++;resolve(false);cov_2bptsyfipc().s[51]++;return;}else{cov_2bptsyfipc().b[16][1]++;}cov_2bptsyfipc().s[52]++;if(hash.checkPassword(req.session.utente.utente.Password.hash,req.session.utente.utente.Password.salt,oldPassword)){cov_2bptsyfipc().b[17][0]++;var passwordHashed=(cov_2bptsyfipc().s[53]++,hash.hashPassword(password));var checkS=(cov_2bptsyfipc().s[54]++,ExternalTutorModel.updatePassword(passwordHashed,req.session.utente.utente.E_mail));/**
        * It checks the result of updatePassword function and updates the external tutor session
        * @param  {Object} result - The result of updatePassword function (about External Tutor)
        * @returns {Boolean} - It returns true and generates an "edit password complete" cookie if result != null, else it returns a reject
        */cov_2bptsyfipc().s[55]++;checkS.then(function(result){cov_2bptsyfipc().f[5]++;cov_2bptsyfipc().s[56]++;if(result!=null){cov_2bptsyfipc().b[18][0]++;cov_2bptsyfipc().s[57]++;req.session.utente.utente=result;cov_2bptsyfipc().s[58]++;res.cookie('updatePassEff','1');cov_2bptsyfipc().s[59]++;resolve(true);}else{cov_2bptsyfipc().b[18][1]++;cov_2bptsyfipc().s[60]++;resolve();}});}else{cov_2bptsyfipc().b[17][1]++;cov_2bptsyfipc().s[61]++;res.cookie('errPassword','1');cov_2bptsyfipc().s[62]++;resolve(false);}});};/**
 * This method retrieves the academic tutor informations by email
 * @param {String} email - external tutor's email to search
 * @returns {JSON} - It returns the JSON object containing the external tutor's informations
 */cov_2bptsyfipc().s[63]++;exports.getByEmail=function(email){cov_2bptsyfipc().f[6]++;cov_2bptsyfipc().s[64]++;return new Promise(function(resolve,reject){cov_2bptsyfipc().f[7]++;var get=(cov_2bptsyfipc().s[65]++,ExternalTutorModel.findByEmail(email));cov_2bptsyfipc().s[66]++;get.then(function(result){cov_2bptsyfipc().f[8]++;cov_2bptsyfipc().s[67]++;resolve({E_mail:result.getEmail(),Surname:result.getSurname(),Name:result.getName(),Organization:result.getOrganization()});});});};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImV4dGVybmFsVHV0b3JDb250cm9sLmpzIl0sIm5hbWVzIjpbImhhc2giLCJyZXF1aXJlIiwiRXh0ZXJuYWxUdXRvck1vZGVsIiwiZXhwb3J0cyIsInVwZGF0ZSIsInJlcSIsInJlcyIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwibmFtZSIsImJvZHkiLCJpbnB1dE5hbWVFIiwic3VybmFtZSIsImlucHV0U3VybmFtZUUiLCJvcmdhbml6YXRpb24iLCJpbnB1dE9yZ2FuaXphdGlvbiIsImV4dGVybmFsVHV0b3IiLCJpc1JpZ2h0IiwibGVuZ3RoIiwidGVzdCIsImNvb2tpZSIsInNldE5hbWUiLCJzZXRTdXJuYW1lIiwic2V0T3JnYW5pemF0aW9uIiwiY2hlY2tTIiwidXBkYXRlRXh0ZXJuYWxUdXRvciIsInNlc3Npb24iLCJ1dGVudGUiLCJFX21haWwiLCJ0aGVuIiwicmVzdWx0IiwidXBkYXRlUGFzc3dvcmQiLCJvbGRQYXNzd29yZCIsImlucHV0T2xkUGFzc3dvcmQiLCJwYXNzd29yZCIsImlucHV0UGFzc3dvcmQiLCJwYXNzd29yZENvbmZpcm0iLCJpbnB1dENvbmZpcm1QYXNzd29yZCIsImNoZWNrUGFzc3dvcmQiLCJQYXNzd29yZCIsInNhbHQiLCJwYXNzd29yZEhhc2hlZCIsImhhc2hQYXNzd29yZCIsImdldEJ5RW1haWwiLCJlbWFpbCIsImdldCIsImZpbmRCeUVtYWlsIiwiZ2V0RW1haWwiLCJTdXJuYW1lIiwiZ2V0U3VybmFtZSIsIk5hbWUiLCJnZXROYW1lIiwiT3JnYW5pemF0aW9uIiwiZ2V0T3JnYW5pemF0aW9uIl0sIm1hcHBpbmdzIjoiNm9VQWVZOzJGQWZaLEdBQUlBLENBQUFBLElBQUksMEJBQUdDLE9BQU8sQ0FBQyxXQUFELENBQVYsQ0FBUixDQUNBLEdBQUlDLENBQUFBLGtCQUFrQiwwQkFBR0QsT0FBTyxDQUFDLDRCQUFELENBQVYsQ0FBdEIsQ0FFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRyx3QkFDQUUsT0FBTyxD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RUFPRCxDQWpCRCxJQWlCTyxzREFDTEYsR0FBRyxDQUFDZSxNQUFKLENBQVcsYUFBWCxDQUEwQixHQUExQixFQURLLHlCQUVMYixPQUFPLENBQUMsS0FBRCxDQUFQLENBQ0QsQ0FDRixDQW5ETSxDQUFQLENBb0RELENBckRELENBdURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRyx5QkFDQUwsT0FBTyxDQUFDeUMsVUFBUixDQUFxQixTQUFVQyxLQUFWLENBQWlCLGtEQUNwQyxNQUFPLElBQUl0QyxDQUFBQSxPQUFKLENBQVksU0FBVUMsT0FBVixDQUFtQkMsTUFBbkIsQ0FBMkIseUJBQzVDLEdBQUlxQyxDQUFBQSxHQUFHLDJCQUFHNUMsa0JBQWtCLENBQUM2QyxXQUFuQixDQUErQkYsS0FBL0IsQ0FBSCxDQUFQLENBRDRDLHlCQUU1Q0MsR0FBRyxDQUFDaEIsSUFBSixDQUFTLFNBQVVDLE1BQVYsQ0FBa0Isa0RBQ3pCdkIsT0FBTyxDQUFDLENBQUVxQixNQUFNLENBQUVFLE1BQU0sQ0FBQ2lCLFFBQVAsRUFBVixDQUE2QkMsT0FBTyxDQUFFbEIsTUFBTSxDQUFDbUIsVUFBUCxFQUF0QyxDQUEyREMsSUFBSSxDQUFFcEIsTUFBTSxDQUFDcUIsT0FBUCxFQUFqRSxDQUFtRkMsWUFBWSxDQUFFdEIsTUFBTSxDQUFDdUIsZUFBUCxFQUFqRyxDQUFELENBQVAsQ0FDRCxDQUZELEVBR0QsQ0FMTSxDQUFQLENBTUQsQ0FQRCIsInNvdXJjZXNDb250ZW50IjpbInZhciBoYXNoID0gcmVxdWlyZSgnLi9oYXNoLmpzJylcbnZhciBFeHRlcm5hbFR1dG9yTW9kZWwgPSByZXF1aXJlKCcuLi9tb2RlbHMvZXh0ZXJuYWx0dXRvci5qcycpXG5cbi8qKlxuICogVGhpcyBtZXRob2QgdXBkYXRlcyB0aGUgZXh0ZXJuYWwgdHV0b3IncyBpbmZvcm1hdGlvbnNcbiAqIEBwYXJhbSB7T2JqZWN0fSByZXEgLSBUaGUgSFRUUCByZXF1ZXN0XG4gKiBAcGFyYW0ge09iamVjdH0gcmVzIC0gVGhlIEhUVFAgcmVzcG9uc2VcbiAqIEByZXR1cm5zIHtCb29sZWFufSAgLSBJdCByZXR1cm5zIHRydWUgaWYgdGhlIHVwZGF0ZSB3YXMgc3VjY2Vzc2Z1bGwsIGVsc2UgZmFsc2VcbiAqL1xuZXhwb3J0cy51cGRhdGUgPSBmdW5jdGlvbiAocmVxLCByZXMpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICB2YXIgbmFtZSA9IHJlcS5ib2R5LmlucHV0TmFtZUVcbiAgICB2YXIgc3VybmFtZSA9IHJlcS5ib2R5LmlucHV0U3VybmFtZUVcbiAgICB2YXIgb3JnYW5pemF0aW9uID0gcmVxLmJvZHkuaW5wdXRPcmdhbml6YXRpb25cblxuICAgIHZhciBleHRlcm5hbFR1dG9yID0gbmV3IEV4dGVybmFsVHV0b3JNb2RlbCgpXG5cbiAgICAvLyBGb3JtIHZhbGlkYXRpb25cbiAgICB2YXIgaXNSaWdodCA9IHRydWVcbiAgICBpZiAobmFtZS5sZW5ndGggIT0gMCkge1xuICAgICAgaWYgKCEoL15bQS1aYS16XSskLy50ZXN0KG5hbWUpKSB8fCBuYW1lLmxlbmd0aCA8PSAyKSB7XG4gICAgICAgIHJlcy5jb29raWUoJ2VycmV4dGVybmFsVHV0b3JOYW1lJywgJzEnKVxuICAgICAgICBpc1JpZ2h0ID0gZmFsc2VcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGV4dGVybmFsVHV0b3Iuc2V0TmFtZShuYW1lKVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChzdXJuYW1lLmxlbmd0aCAhPSAwKSB7XG4gICAgICBpZiAoISgvXltBLVphLXpdKyQvLnRlc3Qoc3VybmFtZSkpIHx8IHN1cm5hbWUubGVuZ3RoIDw9IDIpIHtcbiAgICAgICAgcmVzLmNvb2tpZSgnZXJyZXh0ZXJuYWxUdXRvclN1cm5hbWUnLCAnMScpXG4gICAgICAgIGlzUmlnaHQgPSBmYWxzZVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZXh0ZXJuYWxUdXRvci5zZXRTdXJuYW1lKHN1cm5hbWUpXG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKG9yZ2FuaXphdGlvbi5sZW5ndGggIT0gMCkge1xuICAgICAgaWYgKCEoL15bQS1aYS16XSskLy50ZXN0KG9yZ2FuaXphdGlvbikpIHx8IG9yZ2FuaXphdGlvbi5sZW5ndGggPD0gMikge1xuICAgICAgICByZXMuY29va2llKCdlcnJPcmdhbml6YXRpb25OYW1lJywgJzEnKVxuICAgICAgICBpc1JpZ2h0ID0gZmFsc2VcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGV4dGVybmFsVHV0b3Iuc2V0T3JnYW5pemF0aW9uKG9yZ2FuaXphdGlvbilcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoIWlzUmlnaHQpIHtcbiAgICAgIHJlc29sdmUoZmFsc2UpXG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICB2YXIgY2hlY2tTID0gRXh0ZXJuYWxUdXRvck1vZGVsLnVwZGF0ZUV4dGVybmFsVHV0b3IoZXh0ZXJuYWxUdXRvciwgcmVxLnNlc3Npb24udXRlbnRlLnV0ZW50ZS5FX21haWwpXG4gICAgLyoqXG4gICAgICAgICogSXQgY2hlY2tzIHRoZSByZXN1bHQgb2YgdXBkYXRlRXh0ZXJuYWxUdXRvciBmdW5jdGlvbiBhbmQgdXBkYXRlcyB0aGUgZXh0ZXJuYWwgdHV0b3Igc2Vzc2lvblxuICAgICAgICAqIEBwYXJhbSAge09iamVjdH0gcmVzdWx0IC0gVGhlIHJlc3VsdCBvZiB1cGRhdGVFeHRlcm5hbFR1dG9yIGZ1bmN0aW9uXG4gICAgICAgICogQHJldHVybnMge0Jvb2xlYW59IC0gSXQgcmV0dXJucyB0cnVlIGFuZCBnZW5lcmF0ZXMgYW4gXCJlZGl0IGNvbXBsZXRlXCIgY29va2llIGlmIHJlc3VsdCAhPSBudWxsLCBlbHNlIGl0IHJldHVybnMgYSByZWplY3RcbiAgICAgICAgKi9cbiAgICBjaGVja1MudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICBpZiAocmVzdWx0ICE9IG51bGwpIHtcbiAgICAgICAgcmVxLnNlc3Npb24udXRlbnRlLnV0ZW50ZSA9IHJlc3VsdFxuICAgICAgICByZXMuY29va2llKCd1cGRhdGVFZmYnLCAnMScpXG4gICAgICAgIHJlc29sdmUodHJ1ZSlcbiAgICAgIH0gZWxzZSB7IHJlc29sdmUoKSB9XG4gICAgfSlcbiAgfSlcbn1cblxuLyoqXG4gKiBUaGlzIG1ldGhvZCB1cGRhdGVzIHRoZSBleHRlcm5hbCB0dXRvcidzIHBhc3N3b3JkXG4gKiBAcGFyYW0ge09iamVjdH0gcmVxIC0gVGhlIEhUVFAgcmVxdWVzdFxuICogQHBhcmFtIHtPYmplY3R9IHJlcyAtIFRoZSBIVFRQIHJlc3BvbnNlXG4gKiBAcmV0dXJucyB7Qm9vbGVhbn0gIC0gSXQgcmV0dXJucyB0cnVlIGlmIHRoZSB1cGRhdGUgd2FzIHN1Y2Nlc3NmdWxsLCBlbHNlIGZhbHNlXG4gICovXG5leHBvcnRzLnVwZGF0ZVBhc3N3b3JkID0gZnVuY3Rpb24gKHJlcSwgcmVzKSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgdmFyIG9sZFBhc3N3b3JkID0gcmVxLmJvZHkuaW5wdXRPbGRQYXNzd29yZFxuICAgIHZhciBwYXNzd29yZCA9IHJlcS5ib2R5LmlucHV0UGFzc3dvcmRcbiAgICB2YXIgcGFzc3dvcmRDb25maXJtID0gcmVxLmJvZHkuaW5wdXRDb25maXJtUGFzc3dvcmRcblxuICAgIC8vIEZvcm0gVmFsaWRhdGlvblxuICAgIHZhciBpc1JpZ2h0ID0gdHJ1ZVxuXG4gICAgaWYgKChvbGRQYXNzd29yZCA9PSBudWxsKSB8fCAob2xkUGFzc3dvcmQubGVuZ3RoIDw9IDcpIHx8ICghL15bQS1aYS16MC05XSskLy50ZXN0KG9sZFBhc3N3b3JkKSkpIHtcbiAgICAgIHJlcy5jb29raWUoJ2Vyck9sZFBhc3N3b3JkJywgJzEnKVxuICAgICAgaXNSaWdodCA9IGZhbHNlXG4gICAgfVxuXG4gICAgaWYgKChwYXNzd29yZCA9PSBudWxsKSB8fCAocGFzc3dvcmQubGVuZ3RoIDw9IDcpIHx8ICghL15bQS1aYS16MC05XSskLy50ZXN0KHBhc3N3b3JkKSkpIHtcbiAgICAgIHJlcy5jb29raWUoJ2VyclBhc3N3b3JkJywgJzEnKVxuXG4gICAgICBpc1JpZ2h0ID0gZmFsc2VcbiAgICB9XG5cbiAgICBpZiAocGFzc3dvcmRDb25maXJtICE9IHBhc3N3b3JkKSB7XG4gICAgICByZXMuY29va2llKCdlcnJQYXNzd29yZENvbmZpcm0nLCAnMScpXG5cbiAgICAgIGlzUmlnaHQgPSBmYWxzZVxuICAgIH1cblxuICAgIGlmICghaXNSaWdodCkge1xuICAgICAgcmVzb2x2ZShmYWxzZSlcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIGlmIChoYXNoLmNoZWNrUGFzc3dvcmQocmVxLnNlc3Npb24udXRlbnRlLnV0ZW50ZS5QYXNzd29yZC5oYXNoLCByZXEuc2Vzc2lvbi51dGVudGUudXRlbnRlLlBhc3N3b3JkLnNhbHQsIG9sZFBhc3N3b3JkKSkge1xuICAgICAgdmFyIHBhc3N3b3JkSGFzaGVkID0gaGFzaC5oYXNoUGFzc3dvcmQocGFzc3dvcmQpXG5cbiAgICAgIHZhciBjaGVja1MgPSBFeHRlcm5hbFR1dG9yTW9kZWwudXBkYXRlUGFzc3dvcmQocGFzc3dvcmRIYXNoZWQsIHJlcS5zZXNzaW9uLnV0ZW50ZS51dGVudGUuRV9tYWlsKVxuXG4gICAgICAvKipcbiAgICAgICAgKiBJdCBjaGVja3MgdGhlIHJlc3VsdCBvZiB1cGRhdGVQYXNzd29yZCBmdW5jdGlvbiBhbmQgdXBkYXRlcyB0aGUgZXh0ZXJuYWwgdHV0b3Igc2Vzc2lvblxuICAgICAgICAqIEBwYXJhbSAge09iamVjdH0gcmVzdWx0IC0gVGhlIHJlc3VsdCBvZiB1cGRhdGVQYXNzd29yZCBmdW5jdGlvbiAoYWJvdXQgRXh0ZXJuYWwgVHV0b3IpXG4gICAgICAgICogQHJldHVybnMge0Jvb2xlYW59IC0gSXQgcmV0dXJucyB0cnVlIGFuZCBnZW5lcmF0ZXMgYW4gXCJlZGl0IHBhc3N3b3JkIGNvbXBsZXRlXCIgY29va2llIGlmIHJlc3VsdCAhPSBudWxsLCBlbHNlIGl0IHJldHVybnMgYSByZWplY3RcbiAgICAgICAgKi9cbiAgICAgIGNoZWNrUy50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgaWYgKHJlc3VsdCAhPSBudWxsKSB7XG4gICAgICAgICAgcmVxLnNlc3Npb24udXRlbnRlLnV0ZW50ZSA9IHJlc3VsdFxuICAgICAgICAgIHJlcy5jb29raWUoJ3VwZGF0ZVBhc3NFZmYnLCAnMScpXG4gICAgICAgICAgcmVzb2x2ZSh0cnVlKVxuICAgICAgICB9IGVsc2UgeyByZXNvbHZlKCkgfVxuICAgICAgfSlcbiAgICB9IGVsc2Uge1xuICAgICAgcmVzLmNvb2tpZSgnZXJyUGFzc3dvcmQnLCAnMScpXG4gICAgICByZXNvbHZlKGZhbHNlKVxuICAgIH1cbiAgfSlcbn1cblxuLyoqXG4gKiBUaGlzIG1ldGhvZCByZXRyaWV2ZXMgdGhlIGFjYWRlbWljIHR1dG9yIGluZm9ybWF0aW9ucyBieSBlbWFpbFxuICogQHBhcmFtIHtTdHJpbmd9IGVtYWlsIC0gZXh0ZXJuYWwgdHV0b3IncyBlbWFpbCB0byBzZWFyY2hcbiAqIEByZXR1cm5zIHtKU09OfSAtIEl0IHJldHVybnMgdGhlIEpTT04gb2JqZWN0IGNvbnRhaW5pbmcgdGhlIGV4dGVybmFsIHR1dG9yJ3MgaW5mb3JtYXRpb25zXG4gKi9cbmV4cG9ydHMuZ2V0QnlFbWFpbCA9IGZ1bmN0aW9uIChlbWFpbCkge1xuICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgIHZhciBnZXQgPSBFeHRlcm5hbFR1dG9yTW9kZWwuZmluZEJ5RW1haWwoZW1haWwpXG4gICAgZ2V0LnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgcmVzb2x2ZSh7IEVfbWFpbDogcmVzdWx0LmdldEVtYWlsKCksIFN1cm5hbWU6IHJlc3VsdC5nZXRTdXJuYW1lKCksIE5hbWU6IHJlc3VsdC5nZXROYW1lKCksIE9yZ2FuaXphdGlvbjogcmVzdWx0LmdldE9yZ2FuaXphdGlvbigpIH0pXG4gICAgfSlcbiAgfSlcbn1cbiJdfQ==